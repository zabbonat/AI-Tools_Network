<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Network Visualization - AI Network Turbo</title>
    <link rel="stylesheet" href="../css/main.css">
    <script src="https://unpkg.com/vis-network@9.1.2/dist/vis-network.min.js"></script>
    <style>
        #network-container {
            width: 100%;
            height: calc(100vh - 64px);
            background: var(--color-background);
        }

        .sidebar {
            width: 300px;
            height: calc(100vh - 64px);
            background: var(--color-secondary);
            border-right: 1px solid var(--color-border);
            overflow-y: auto;
            transition: transform 300ms cubic-bezier(0.4, 0, 0.2, 1);
        }

        .sidebar-mobile {
            position: fixed;
            top: 64px;
            left: 0;
            z-index: 40;
            transform: translateX(-100%);
        }

        .sidebar-mobile.open {
            transform: translateX(0);
        }

        .control-panel {
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
            background: rgba(255, 255, 255, 0.02);
        }

        .stat-card {
            background: linear-gradient(135deg, rgba(255, 75, 75, 0.1) 0%, rgba(77, 171, 247, 0.1) 100%);
            border: 1px solid var(--color-border);
            border-radius: 0.5rem;
            padding: 1rem;
        }

        .loader-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(14, 17, 23, 0.95);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid var(--color-border);
            border-top-color: var(--color-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        .range-input {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 6px;
            background: var(--color-surface);
            border-radius: 3px;
            outline: none;
        }

        .range-input::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 18px;
            height: 18px;
            background: var(--color-primary);
            border-radius: 50%;
            cursor: pointer;
            transition: transform 150ms ease;
        }

        .range-input::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .range-input::-moz-range-thumb {
            width: 18px;
            height: 18px;
            background: var(--color-primary);
            border-radius: 50%;
            cursor: pointer;
            border: none;
            transition: transform 150ms ease;
        }

        .range-input::-moz-range-thumb:hover {
            transform: scale(1.2);
        }

        @media (max-width: 768px) {
            .sidebar {
                width: 280px;
            }

            #network-container {
                height: calc(100vh - 120px);
            }
        }
    </style>

    <script type="module" async
        src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fainetwork8711back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.10"></script>
    <script type="module" defer src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
</head>

<body class="bg-background text-text-primary">
    <!-- Header Navigation -->
    <header class="bg-surface-elevated border-b border-border sticky top-0 z-30">
        <nav class="max-w-full mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <!-- Logo -->
                <div class="flex items-center gap-3">
                    <svg class="w-10 h-10" viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect width="40" height="40" rx="8" fill="url(#logo-gradient)" />
                        <path d="M20 10L28 16V24L20 30L12 24V16L20 10Z" stroke="white" stroke-width="2"
                            stroke-linejoin="round" />
                        <circle cx="20" cy="20" r="3" fill="white" />
                        <defs>
                            <linearGradient id="logo-gradient" x1="0" y1="0" x2="40" y2="40"
                                gradientUnits="userSpaceOnUse">
                                <stop stop-color="#ff4b4b" />
                                <stop offset="1" stop-color="#4dabf7" />
                            </linearGradient>
                        </defs>
                    </svg>
                    <div>
                        <h1 class="text-xl font-bold text-text-primary">AI Network Turbo</h1>
                        <p class="text-xs text-text-secondary">Architecture Diffusion Analysis</p>
                    </div>
                </div>

                <!-- Navigation Links -->
                <div class="hidden md:flex items-center gap-6">
                    <a href="network_visualization.html"
                        class="text-primary font-medium border-b-2 border-primary pb-1">
                        Visualization
                    </a>
                    <a href="data_import_manager.html"
                        class="text-text-secondary hover:text-text-primary transition-colors duration-200">
                        Data Management
                    </a>
                </div>

                <!-- Mobile Menu Button -->
                <button id="mobile-menu-btn"
                    class="md:hidden p-2 rounded-lg hover:bg-surface transition-colors touch-target">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                            d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </nav>
    </header>

    <!-- Main Content -->
    <div class="flex relative">
        <!-- Sidebar Controls -->
        <aside id="sidebar" class="sidebar">
            <div class="p-4 space-y-6">
                <!-- Statistics Cards -->
                <div class="space-y-3">
                    <h2 class="text-lg font-semibold text-text-primary flex items-center gap-2">
                        <svg class="w-5 h-5 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                        Network Stats
                    </h2>

                    <div class="stat-card">
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-text-secondary">Total Publications</span>
                            <svg class="w-5 h-5 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
                            </svg>
                        </div>
                        <p id="total-publications" class="text-2xl font-bold text-text-primary mt-2 font-mono">0</p>
                    </div>

                    <div class="stat-card">
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-text-secondary">Active Nodes</span>
                            <svg class="w-5 h-5 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13 10V3L4 14h7v7l9-11h-7z" />
                            </svg>
                        </div>
                        <p id="active-nodes" class="text-2xl font-bold text-text-primary mt-2 font-mono">0</p>
                    </div>

                    <div class="stat-card">
                        <div class="flex items-center justify-between">
                            <span class="text-sm text-text-secondary">Connections</span>
                            <svg class="w-5 h-5 text-primary" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1" />
                            </svg>
                        </div>
                        <p id="connections-count" class="text-2xl font-bold text-text-primary mt-2 font-mono">0</p>
                    </div>
                </div>

                <!-- Year Range Filter -->
                <div class="control-panel p-4">
                    <h3 class="text-sm font-semibold text-text-primary mb-3 flex items-center gap-2">
                        <svg class="w-4 h-4 text-accent" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                        </svg>
                        Year Range
                    </h3>
                    <div class="grid grid-cols-2 gap-3">
                        <div>
                            <label for="year-start" class="block text-xs text-text-secondary mb-1">From</label>
                            <input type="number" id="year-start" min="2000" max="2025" value="2000"
                                class="input text-sm py-2 font-mono">
                        </div>
                        <div>
                            <label for="year-end" class="block text-xs text-text-secondary mb-1">To</label>
                            <input type="number" id="year-end" min="2000" max="2025" value="2025"
                                class="input text-sm py-2 font-mono">
                        </div>
                    </div>
                </div>

                <!-- Publication Threshold -->
                <div class="control-panel p-4">
                    <div class="flex items-center justify-between mb-3">
                        <h3 class="text-sm font-semibold text-text-primary flex items-center gap-2">
                            <svg class="w-4 h-4 text-warning" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                    d="M3 4h13M3 8h9m-9 4h6m4 0l4-4m0 0l4 4m-4-4v12" />
                            </svg>
                            Publication Threshold
                        </h3>
                        <span id="threshold-value" class="text-sm font-bold text-primary font-mono">0</span>
                    </div>
                    <input type="range" id="publication-threshold" min="0" max="500" value="0"
                        class="range-input w-full">
                    <div class="flex justify-between text-xs text-text-tertiary mt-2">
                        <span>0</span>
                        <span>500</span>
                    </div>
                </div>

                <!-- Architecture Filter -->
                <div class="control-panel p-4">
                    <h3 class="text-sm font-semibold text-text-primary mb-3 flex items-center gap-2">
                        <svg class="w-4 h-4 text-success" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
                        </svg>
                        Filter Architecture
                    </h3>
                    <select id="architecture-filter" class="input text-sm">
                        <option value="">All Architectures</option>
                        <!-- Populated dynamically -->
                    </select>
                </div>

                <!-- Action Buttons -->
                <div class="space-y-3">
                    <button id="center-network-btn"
                        class="btn btn-accent w-full flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
                        </svg>
                        Center Network
                    </button>

                    <button id="fit-network-btn"
                        class="btn btn-secondary w-full flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
                        </svg>
                        Fit View
                    </button>

                    <button id="refresh-data-btn" class="btn btn-primary w-full flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                                d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        Refresh Data
                    </button>
                </div>
            </div>
        </aside>

        <!-- Network Visualization Area -->
        <main class="flex-1 relative">
            <!-- Mobile Controls Toggle -->
            <button id="toggle-sidebar-btn"
                class="md:hidden fixed bottom-6 left-6 z-30 bg-primary text-white p-4 rounded-full shadow-xl touch-target">
                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
                        d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" />
                </svg>
            </button>

            <!-- Network Container -->
            <div id="network-container"></div>

            <!-- Loading Overlay -->
            <div id="loader-overlay" class="loader-overlay" style="display: none;">
                <div class="spinner"></div>
                <p class="text-text-primary mt-6 text-lg font-medium">Loading Data...</p>
                <p id="loading-percentage" class="text-text-secondary mt-2 font-mono">0%</p>
            </div>
        </main>
    </div>

    <script src="../js/data_utils.js"></script>
    <script src="../js/network_viz.js"></script>
    <script id="dhws-dataInjector" src="../public/dhws-data-injector.js"></script>
</body>

</html>